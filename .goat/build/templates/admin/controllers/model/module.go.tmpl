{{define "admin.controllers.model.module" -}}
{{- $ctx := . -}}
{{- $entityName := (camelcaseuf (index $ctx.Data (print .From ".entity"))) -}}

package {{lower $entityName}}

import (
	"github.com/goatcms/goatcore/app"
	"github.com/goatcms/goatcms/cmsapp/services"
)

// InitDependencies initialize the {{$entityName}} controllers
func InitDependencies(a app.App) error {
	var deps struct {
		Router services.Router `dependency:"RouterService"`
	}
	dp := a.DependencyProvider()
	if err := dp.InjectTo(&deps); err != nil {
		return err
	}
	// add list controller
	list, err := NewList(dp)
	if err != nil {
		return err
	}
	deps.Router.OnGet("/admin/{{lower $entityName}}", list.Get)
	// add inserter
	inserter, err := NewInserter(dp)
	if err != nil {
		return err
	}
	deps.Router.OnGet("/admin/{{lower $entityName}}/insert", inserter.Get)
	deps.Router.OnPost("/admin/{{lower $entityName}}/insert", inserter.Post)
	// add updater
	updater, err := NewUpdater(dp)
	if err != nil {
		return err
	}
	deps.Router.OnGet("/admin/{{lower $entityName}}/{id:[0-9]+}", updater.Get)
	deps.Router.OnPost("/admin/{{lower $entityName}}/{id:[0-9]+}", updater.Post)
	// add deleter
	deleter, err := NewDeleter(dp)
	if err != nil {
		return err
	}
	deps.Router.OnPost("/admin/{{lower $entityName}}/{id:[0-9]+}$delete", deleter.DO)
	return nil
}


{{- end -}}
